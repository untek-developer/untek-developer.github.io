var l=Object.defineProperty;var u=(e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var c=(e,t,n)=>(u(e,typeof t!="symbol"?t+"":t,n),n);import{r as d,u as f,j as i}from"./index-tAxGdBJP.js";import{a as p}from"./apiClient-Hrr0e7fx.js";import{A as x,M as b}from"./AbstractApiClient-0xmu0Kex.js";import{H as h}from"./Html-D7heW40j.js";import{B as g}from"./Breadcrumbs-NSTM816m.js";import"./Anchor-6US6y0OC.js";function A(e){return e.substring(0,e.lastIndexOf("/")+1)}function m(e){return"/reader/"+e.bookName+"/"+A(e.id)}function j(e){const t=/src="(.+)"/gi,n="/rest-api"+m(e);e.content=e.content.replaceAll(t,'src="'+n+'$1"')}function k(e){const t=/href="(.+)"/gi,n="#"+m(e);e.content=e.content.replaceAll(t,'href="'+n+'$1"')}function M(e){const t=new b;e.contentMd&&(e.content=t.render(e.contentMd))}class w extends x{constructor(){super(...arguments);c(this,"listUri","reader/list.json")}fetchByIds(n,r){return p.getText("reader/"+r+"/"+n).then(o=>{const a=n.split(".").pop(),s={id:n,bookName:r};return a=="md"&&(s.contentMd=o),a=="html"&&(s.content=o),M(s),j(s),k(s),s})}}const E=new w,N=e=>{const t=e.item;return i.jsx(h,{children:t.content})};function R(e){return e==""&&(e="README.md"),e}function $(e){const[t,n]=d.useState({});let r,o;if(e.id)r=e.id,o=e.bookName;else{const a=f();r=R(a["*"]),o=a.bookName}return d.useEffect(()=>{E.fetchByIds(r,o).then(a=>{n(a)})},[r,o]),i.jsxs(i.Fragment,{children:[i.jsx(g,{items:[{label:t.bookName,url:"/reader/"+t.bookName}]}),i.jsx(N,{item:t})]})}export{$ as default};
